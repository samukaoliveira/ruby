<%= render "layouts/header" %>

<br><br>


        <form name="calcular" method="post" action="">
            
            <h3>Macro de Cálculo (FPCLPAGTO)</h3>
            
            <label for="siape">Copie e cole aqui as SIAPEs do Excel</label><BR>
			<textarea id="siapes" style="width: 400px; height: 150px"  size="480" maxlength="480" name="siapes" placeholder="Copie e cola aqui as SIAPEs do Excel" >
			</textarea><br>
           			
			<input type="button" value="Inserir Matrículas" onclick="insereMats();"><br><br>
			
            
			<label for="siape">Confira se as SIAPEs estão OK e clique em Gerar Macro.</label><BR>
            <input type="number" size="7" maxlength="7" name="siape1" id="1" value"">
			<input type="text" size="35" maxlength="50" name="nome1" id="nome1"  value"">
			<input type="number" size="7" maxlength="7" name="siape2" id="2" value"">
			<input type="text" size="35" maxlength="50" name="nome2" id="nome2"  value""><br>
			<input type="number" size="7" maxlength="7" name="siape3" id="3" value"">
			<input type="text" size="35" maxlength="50" name="nome3" id="nome3"  value"">
			<input type="number" size="7" maxlength="7" name="siape4" id="4" value"">
			<input type="text" size="35" maxlength="50" name="nome4" id="nome4"  value""><br>
			<input type="number" size="7" maxlength="7" name="siape5" id="5" value"">
			<input type="text" size="35" maxlength="50" name="nome5" id="nome5"  value"">
			<input type="number" size="7" maxlength="7" name="siape6" id="6" value"">
			<input type="text" size="35" maxlength="50" name="nome6" id="nome6"  value""><br>
			<input type="number" size="7" maxlength="7" name="siape7" id="7" value"">
			<input type="text" size="35" maxlength="50" name="nome7" id="nome7"  value"">
			<input type="number" size="7" maxlength="7" name="siape8" id="8" value"">
			<input type="text" size="35" maxlength="50" name="nome8" id="nome8"  value""><br>
			<input type="number" size="7" maxlength="7" name="siape9" id="9" value"">
			<input type="text" size="35" maxlength="50" name="nome9" id="nome9"  value"">
			<input type="number" size="7" maxlength="7" name="siape10" id="10" value"">
			<input type="text" size="35" maxlength="50" name="nome10" id="nome10"  value""><br>
			<input type="number" size="7" maxlength="7" name="siape11" id="11" value"">
			<input type="text" size="35" maxlength="50" name="nome11" id="nome11"  value"">
			<input type="number" size="7" maxlength="7" name="siape12" id="12" value"">
			<input type="text" size="35" maxlength="50" name="nome12" id="nome12"  value""><br>
			<input type="number" size="7" maxlength="7" name="siape13" id="13" value"">
			<input type="text" size="35" maxlength="50" name="nome13" id="nome13"  value"">
			<input type="number" size="7" maxlength="7" name="siape14" id="14" value"">
			<input type="text" size="35" maxlength="50" name="nome14" id="nome14"  value""><br>
			<input type="number" size="7" maxlength="7" name="siape15" id="15" value"">
			<input type="text" size="35" maxlength="50" name="nome15" id="nome15"  value"">
			<input type="number" size="7" maxlength="7" name="siape16" id="16" value"">
			<input type="text" size="35" maxlength="50" name="nome16" id="nome16"  value""><br>
			<input type="number" size="7" maxlength="7" name="siape17" id="17" value"">
			<input type="text" size="35" maxlength="50" name="nome17" id="nome17"  value"">
			<input type="number" size="7" maxlength="7" name="siape18" id="18" value"">
			<input type="text" size="35" maxlength="50" name="nome18" id="nome18"  value""><br>
			<input type="number" size="7" maxlength="7" name="siape19" id="19" value"">
			<input type="text" size="35" maxlength="50" name="nome19" id="nome19"  value"">
			<input type="number" size="7" maxlength="7" name="siape20" id="20" value"">
			<input type="text" size="35" maxlength="50" name="nome20" id="nome20"  value""><br>
			<input type="number" size="7" maxlength="7" name="siape21" id="21" value"">
			<input type="text" size="35" maxlength="50" name="nome21" id="nome21"  value"">
			<input type="number" size="7" maxlength="7" name="siape22" id="22" value"">
			<input type="text" size="35" maxlength="50" name="nome22" id="nome22"  value""><br>
			<input type="number" size="7" maxlength="7" name="siape23" id="23" value"">
			<input type="text" size="35" maxlength="50" name="nome23" id="nome23"  value"">
			<input type="number" size="7" maxlength="7" name="siape24" id="24" value"">
			<input type="text" size="35" maxlength="50" name="nome24" id="nome24"  value""><br>
			<input type="number" size="7" maxlength="7" name="siape25" id="25" value"">
			<input type="text" size="35" maxlength="50" name="nome25" id="nome25"  value"">
			<input type="number" size="7" maxlength="7" name="siape26" id="26" value"">
			<input type="text" size="35" maxlength="50" name="nome26" id="nome26"  value""><br>
			<input type="number" size="7" maxlength="7" name="siape27" id="27" value"">
			<input type="text" size="35" maxlength="50" name="nome27" id="nome27"  value"">
			<input type="number" size="7" maxlength="7" name="siape28" id="28" value"">
			<input type="text" size="35" maxlength="50" name="nome28" id="nome28"  value""><br>
			<input type="number" size="7" maxlength="7" name="siape29" id="29" value"">
			<input type="text" size="35" maxlength="50" name="nome29" id="nome29"  value"">
			<input type="number" size="7" maxlength="7" name="siape30" id="30" value"">
			<input type="text" size="35" maxlength="50" name="nome30" id="nome30"  value""><br>
			<input type="number" size="7" maxlength="7" name="siape31" id="31" value"">
			<input type="number" size="7" maxlength="7" name="siape32" id="32" value"">
			<input type="number" size="7" maxlength="7" name="siape33" id="33" value"">
			<input type="number" size="7" maxlength="7" name="siape34" id="34" value"">
			<input type="number" size="7" maxlength="7" name="siape35" id="35" value""><br>
			<input type="number" size="7" maxlength="7" name="siape36" id="36" value"">
			<input type="number" size="7" maxlength="7" name="siape37" id="37" value"">
			<input type="number" size="7" maxlength="7" name="siape38" id="38" value"">
			<input type="number" size="7" maxlength="7" name="siape39" id="39" value"">
			<input type="number" size="7" maxlength="7" name="siape40" id="40" value""><br>
			<input type="number" size="7" maxlength="7" name="siape41" id="41" value"">
			<input type="number" size="7" maxlength="7" name="siape42" id="42" value"">
			<input type="number" size="7" maxlength="7" name="siape43" id="43" value"">
			<input type="number" size="7" maxlength="7" name="siape44" id="44" value"">
			<input type="number" size="7" maxlength="7" name="siape45" id="45" value""><br>
			<input type="number" size="7" maxlength="7" name="siape46" id="46" value"">
			<input type="number" size="7" maxlength="7" name="siape47" id="47" value"">
			<input type="number" size="7" maxlength="7" name="siape48" id="48" value"">
			<input type="number" size="7" maxlength="7" name="siape49" id="49" value"">
			<input type="number" size="7" maxlength="7" name="siape50" id="50" value""><br>
			<input type="number" size="7" maxlength="7" name="siape52" id="51" value"">
			<input type="number" size="7" maxlength="7" name="siape52" id="52" value"">
			<input type="number" size="7" maxlength="7" name="siape53" id="53" value"">
			<input type="number" size="7" maxlength="7" name="siape54" id="54" value"">
			<input type="number" size="7" maxlength="7" name="siape55" id="55" value""><br>
			<input type="number" size="7" maxlength="7" name="siape56" id="56" value"">
			<input type="number" size="7" maxlength="7" name="siape57" id="57" value"">
			<input type="number" size="7" maxlength="7" name="siape58" id="58" value"">
			<input type="number" size="7" maxlength="7" name="siape59" id="59" value"">
			<input type="number" size="7" maxlength="7" name="siape60" id="60" value""><br>

            
        </form>
        <br><br>
		
		     
		    <input type="button" value="Gerar Macro - Selenium IDE" onclick="geraMacroSelenium();">
		    <input type="button" value="Gerar Macro - UI Vision RPA" onclick="geraMacroUIVision();">
			<input type="button" value="Gerar Processamento Batch - Siapenet" onclick="geraProcessamentoBatch();">

			
            <input type="button" value="Reset" onclick="apagaDiv();">
        

		<br><br><br><br>
	
            
    
	<script src="FileSaver.js"></script>
	<script src="jquery-1.5.2.min.js"></script>
		<script src="jquery.maskedinput-1.3.min.js"></script>
	
	<script type="text/javascript">
	//	jQuery(function($){
    //  $('#siapes').mask('9999999;9999999;9999999;9999999;9999999;9999999;9999999;9999999;9999999;9999999;9999999;9999999;9999999;9999999;9999999;');
    //  });
	
	</script>
	
	
    
    <script>
	
	function insereMats(){
	
	var siapeExcel = document.getElementById("siapes").value;
	var siapes = new Array();
	var a=1;
	var str=0
	
	while (a <= 60){
	siapes[a] = siapeExcel.substr(str, 7);
	document.getElementById(a).value = siapes[a];
	a++;
	str += 8;
	}
	
	//cria a div das rubricas
    
	
	
	}
	
    
    function geraMacroSelenium(){
        

var i = 1;
var i2 = 1;
var f = 0;
var siape = new Array();

//pega o valor dos atrasados de vencimento e soma ao valor total de V.B.

while ((document.getElementById(i2).value > 0) && (i2 < 61)){
	f++;
	i2++;
	}


 // siape[1] = document.getElementById("1").value;
 // siape[2] = document.getElementById("2").value;
 // siape[3] = document.getElementById("3").value;
 // siape[4] = document.getElementById("4").value;
  // siape[5] = document.getElementById("5").value;
  // siape[6] = document.getElementById("6").value;
  // siape[7] = document.getElementById("7").value;
  // siape[8] = document.getElementById("8").value;
  // siape[9] = document.getElementById("9").value;
  // siape[10] = document.getElementById("10").value;
  // siape[11] = document.getElementById("11").value;
  // siape[12] = document.getElementById("12").value;
  // siape[13] = document.getElementById("13").value;
  // siape[14] = document.getElementById("14").value;
  // siape[15] = document.getElementById("15").value;
        
        /*
    if (siape[1] > 0){
        f =1;    }
	if (siape[2] > 0){
        f =2;    }
	if (siape[3] > 0){
        f =3;    }
	if (siape[4] > 0){
        f =4;    }
	if (siape[5] > 0){
        f =5;    }
	if (siape[6] > 0){
        f =6;    }
	if (siape[7] > 0){
        f =7;    }
	if (siape[8] > 0){
        f =8;    }
	if (siape[9] > 0){
        f =9;    }
	if (siape[10] > 0){
        f =10;    }
	if (siape[11] > 0){
        f =11;    }
	if (siape[12] > 0){
        f =12;    }
	if (siape[13] > 0){
        f =13;    }
	if (siape[14] > 0){
        f =14;    }
	if (siape[15] > 0){
        f =15;    }
    */
	
var macro = '{ \n '+
'  "id": "6a58b9b4-ad78-4055-a7ee-532f4'+document.getElementById(i).value+'", \n '+
'  "version": "2.0", \n '+
'  "name": "calculo", \n '+
'  "url": "https://esiape.sigepe.gov.br", \n '+
'  "tests": [{ \n '+
'    "id": "65b28aef-d68d-46d7-b59a-e00cd'+document.getElementById(i).value+'", \n '+
'    "name": "calculo2", \n '+
'    "Commands": [{ \n '+
'      "id": "3e237984-1862-4263-b535-14785'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "open", \n '+
'      "target": "/modsiape/servlet/StartCISPage?PAGEURL=/cisnatural/NatLogon.html&xciParameters.natsession=modsiape", \n '+
'      "targets": [], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "60848875-eb83-465b-b102-12328'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "setWindowSize", \n '+
'      "target": "683x728", \n '+
'      "targets": [], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "f8f838cf-4ebd-4df6-b33c-142a3'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "selectFrame", \n '+
'      "target": "index=1", \n '+
'      "targets": [ \n '+
'        ["index=1"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "5f73920e-216d-4cf9-9821-8b313'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "click", \n '+
'      "target": "id=B_13", \n '+
'      "targets": [ \n '+
'        ["id=B_13", "id"], \n '+
'        ["name=CC", "name"], \n '+
'        ["css=#B_13", "css:finder"], \n '+
'        ["xpath=//button[@id=\'B_13\']", "xpath:attributes"], \n '+
'        ["xpath=//td[@id=\'TDB13\']/button", "xpath:idRelative"], \n '+
'        ["xpath=//button", "xpath:position"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "c9832455-3023-4822-a416-cee0a'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "pause", \n '+
'      "target": "", \n '+
'      "targets": [], \n '+
'      "value": "2000" \n '+
'    }, { \n '+
'      "id": "b6a27fc1-d901-4fd5-92d5-f1a4d'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "selectFrame", \n '+
'      "target": "relative=parent", \n '+
'      "targets": [ \n '+
'        ["relative=parent"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "6eedd709-c25d-43c7-b853-4412f'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "click", \n '+
'      "target": "css=.INTPOPUPCellClose", \n '+
'      "targets": [ \n '+
'        ["css=.INTPOPUPCellClose", "css:finder"], \n '+
'        ["xpath=//td[@id=\'TITLEBAR0_2CLOSE\']/div", "xpath:idRelative"], \n '+
'        ["xpath=//td[3]/div", "xpath:position"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "756f1807-155b-4876-a17f-288fb'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "pause", \n '+
'      "target": "", \n '+
'      "targets": [], \n '+
'      "value": "2000" \n '+
'    }, { \n '+
'      "id": "157bee95-54d0-4076-82bd-464b8'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "selectFrame", \n '+
'      "target": "index=3", \n '+
'      "targets": [ \n '+
'        ["index=3"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "f3354559-d38e-4049-9907-14bc0'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "pause", \n '+
'      "target": "", \n '+
'      "targets": [], \n '+
'      "value": "2000" \n '+
'    }, { \n '+
'      "id": "56fc4243-92bb-4f72-aadb-cb689'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "click", \n '+
'      "target": "id=B_377", \n '+
'      "targets": [ \n '+
'        ["id=B_377", "id"], \n '+
'        ["css=#B_377", "css:finder"], \n '+
'        ["xpath=//button[@id=\'B_377\']", "xpath:attributes"], \n '+
'        ["xpath=//td[@id=\'TDB377\']/button", "xpath:idRelative"], \n '+
'        ["xpath=//td[7]/button", "xpath:position"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "cf4f42b7-005e-422e-aa2b-98324'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "selectFrame", \n '+
'      "target": "relative=parent", \n '+
'      "targets": [ \n '+
'        ["relative=parent"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "d1f83801-d9e9-48cb-ac18-922e1'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "selectFrame", \n '+
'      "target": "index=0", \n '+
'      "targets": [ \n '+
'        ["index=0"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "63726a06-b67e-420f-a993-c6180'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "click", \n '+
'      "target": "id=ICONIMG14", \n '+
'      "targets": [ \n '+
'        ["id=ICONIMG14", "id"], \n '+
'        ["css=#ICONIMG14", "css:finder"], \n '+
'        ["xpath=//img[@title=\'Pesquisar transação\']", "xpath:img"], \n '+
'        ["xpath=//img[@id=\'ICONIMG14\']", "xpath:attributes"], \n '+
'        ["xpath=//td[@id=\'ICON14\']/img", "xpath:idRelative"], \n '+
'        ["xpath=//td[2]/table/tbody/tr/td/img", "xpath:position"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "c5f5746c-3681-463e-94f6-82cd0'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "type", \n '+
'      "target": "id=F_62", \n '+
'      "targets": [ \n '+
'        ["id=F_62", "id"], \n '+
'        ["name=CC", "name"], \n '+
'        ["css=#F_62", "css:finder"], \n '+
'        ["xpath=//input[@id=\'F_62\']", "xpath:attributes"], \n '+
'        ["xpath=//tr[@id=\'ITR59\']/td/table/tbody/tr/td[3]/input", "xpath:idRelative"], \n '+
'        ["xpath=//input", "xpath:position"] \n '+
'      ], \n '+
'      "value": "fpclpagto" \n '+
'    }, { \n '+
'      "id": "06b1a345-6f68-424b-8b81-43033'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "selectFrame", \n '+
'      "target": "relative=parent", \n '+
'      "targets": [ \n '+
'        ["relative=parent"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }  '+
', {  \n '+
'      "id": "6d2d25ca-461e-407c-8b66-55ea2'+document.getElementById(i).value+'", \n '+
'     "comment": "", \n '+
'      "command": "selectFrame", \n '+
'      "target": "index=1", \n '+
'      "targets": [ \n '+
'        ["index=1"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "24454284-9dc9-4267-baca-80110'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "click", \n '+
'      "target": "id=B_78", \n '+
'      "targets": [ \n '+
'        ["id=B_78", "id"], \n '+
'        ["css=#B_78", "css:finder"], \n '+
'        ["xpath=//button[@id=\'B_78\']", "xpath:attributes"], \n '+
'        ["xpath=//td[@id=\'TDB78\']/button", "xpath:idRelative"], \n '+
'        ["xpath=//tr[2]/td/table/tbody/tr/td/button", "xpath:position"], \n '+
'        ["xpath=//button[contains(.,\' EFETUAR CÁLCULO ONLINE\')]", "xpath:innerText"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }';


while (i <= f){



    macro += ', { \n '+
'      "id": "126c61fb-841f-4c2a-8991-ad50c'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "selectFrame", \n '+
'      "target": "relative=parent", \n '+
'      "targets": [ \n '+
'        ["relative=parent"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "fd344c7d-7e08-4f67-9210-a6bf5'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "selectFrame", \n '+
'      "target": "index=2", \n '+
'      "targets": [ \n '+
'        ["index=2"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "d23b662f-5397-4160-af27-72728'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "type", \n '+
'      "target": "id=F_130", \n '+
'      "targets": [ \n '+
'        ["id=F_130", "id"], \n '+
'        ["css=#F_130", "css:finder"], \n '+
'        ["xpath=//input[@id=\'F_130\']", "xpath:attributes"], \n '+
'        ["xpath=//tr[@id=\'ITR127\']/td/table/tbody/tr/td[3]/input", "xpath:idRelative"], \n '+
'        ["xpath=//tr[3]/td/table/tbody/tr/td[3]/input", "xpath:position"] \n '+
'      ], \n '+
'      "value": "'+document.getElementById(i).value+'" \n '+
'    }, { \n '+
'      "id": "444cb459-f313-4a9b-8d80-c0f0e'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "sendKeys", \n '+
'      "target": "id=F_134", \n '+
'      "targets": [ \n '+
'        ["id=F_134", "id"], \n '+
'        ["css=#F_134", "css:finder"], \n '+
'        ["xpath=//input[@id=\'F_134\']", "xpath:attributes"], \n '+
'        ["xpath=//tr[@id=\'ITR127\']/td/table/tbody/tr/td[7]/input", "xpath:idRelative"], \n '+
'        ["xpath=//td[7]/input", "xpath:position"] \n '+
'      ], \n '+
'      "value": "${KEY_ENTER}" \n '+
'    }, { \n '+
'      "id": "c812a8a6-ed02-4be0-882a-51ad3'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "selectFrame", \n '+
'      "target": "relative=parent", \n '+
'      "targets": [ \n '+
'        ["relative=parent"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "539c1eab-a0f1-4a23-a5e6-2a3e4'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "selectFrame", \n '+
'      "target": "index=0", \n '+
'      "targets": [ \n '+
'        ["index=0"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "2ac1dede-884f-4f54-bb31-f8c87'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "click", \n '+
'      "target": "id=B_123", \n '+
'      "targets": [ \n '+
'        ["id=B_123", "id"], \n '+
'        ["css=#B_123", "css:finder"], \n '+
'        ["xpath=//button[@id=\'B_123\']", "xpath:attributes"], \n '+
'        ["xpath=//td[@id=\'TDB123\']/button", "xpath:idRelative"], \n '+
'        ["xpath=//td[3]/button", "xpath:position"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "8afe8e6b-d846-43e0-b437-5bdb5'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "selectFrame", \n '+
'      "target": "relative=parent", \n '+
'      "targets": [ \n '+
'        ["relative=parent"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "59a60d03-d3c6-4644-9bd6-2c59a'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "selectFrame", \n '+
'      "target": "index=1", \n '+
'      "targets": [ \n '+
'        ["index=1"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "d014a4f4-5712-4f67-bfd0-3b91f'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "click", \n '+
'      "target": "id=B_190", \n '+
'      "targets": [ \n '+
'        ["id=B_190", "id"], \n '+
'        ["css=#B_190", "css:finder"], \n '+
'        ["xpath=//button[@id=\'B_190\']", "xpath:attributes"], \n '+
'        ["xpath=//td[@id=\'TDB190\']/button", "xpath:idRelative"], \n '+
'        ["xpath=//td[9]/button", "xpath:position"] \n '+
'      ], \n '+
'      "value": "", \n '+
'      "opensWindow": true, \n '+
'      "windowHandleName": "win2279", \n '+
'      "windowTimeout": 2000 \n '+
'    }, { \n '+
'      "id": "543119e4-8d6b-4998-a6e2-1a75a'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "pause", \n '+
'      "target": "13000", \n '+
'      "targets": [], \n '+
'      "value": "" \n '+
'    }, { \n '+
'      "id": "a4ca9924-cd5a-4aa8-8fbc-df180'+document.getElementById(i).value+'", \n '+
'      "comment": "", \n '+
'      "command": "click", \n '+
'      "target": "id=B_194", \n '+
'      "targets": [ \n '+
'        ["id=B_194", "id"], \n '+
'        ["css=#B_194", "css:finder"], \n '+
'        ["xpath=//button[@id=\'B_194\']", "xpath:attributes"], \n '+
'        ["xpath=//td[@id=\'TDB194\']/button", "xpath:idRelative"], \n '+
'        ["xpath=//td[13]/button", "xpath:position"] \n '+
'      ], \n '+
'      "value": "" \n '+
'    }';


 i++;

}
 
  
    
    macro += ' ] \n '+
'  }], \n '+
'  "suites": [{ \n '+
'    "id": "c88087ae-1ba2-4bb8-915b-ee092ef61689", \n '+
'    "name": "Default Suite", \n '+
'    "persistSession": false, \n '+
'    "parallel": false, \n '+
'    "timeout": 300, \n '+
'    "tests": ["65b28aef-d68d-46d7-b59a-e00cd8096189"] \n '+
'  }], \n '+
'  "urls": ["https://esiape.sigepe.gov.br/"], \n '+
'  "plugins": [] \n '+
'}';
    
    let texto = macro;
      let titulo = "FPCLPAGTO";
   let blob = new Blob([texto], { type: "text/plain;charset=iso-8859-1" });
      saveAs(blob, titulo + ".side");
    
}

// começo da macro UI Vision


function geraMacroUIVision(){
        

var i = 1;
var i2 = 1;
var f = 0;
var siape = new Array();

//pega o valor dos atrasados de vencimento e soma ao valor total de V.B.

while ((document.getElementById(i2).value > 0) && (i2 < 61)){
	f++;
	i2++;
	}


 
	
var macro = '{ \n '+
'  "name": "Calculo'+siape[1]+'", \n '+
'  "CreationDate": "2022-8-4", \n '+
'  "Commands": [{ \n '+
'      "Command": "open", \n '+
'      "Target": "https://esiape.sigepe.gov.br/modsiape/", \n '+
'      "Targets": [], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "setWindowSize", \n '+
'      "Target": "683x728", \n '+
'      "Targets": [], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "XType", \n '+
'      "Target": "${KEY_ENTER}", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, { \n '+
'      "Command": "pause", \n '+
'      "Target": "700", \n '+
'      "Targets": [], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "XType", \n '+
'      "Target": "${KEY_ENTER}", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, { \n '+
'      "Command": "pause", \n '+
'      "Target": "700", \n '+
'      "Targets": [], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "selectFrame", \n '+
'      "Target": "relative=parent", \n '+
'      "Targets": [ \n '+
'        ["relative=parent"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "click", \n '+
'      "Target": "css=.INTPOPUPCellClose", \n '+
'      "Targets": [ \n '+
'        ["css=.INTPOPUPCellClose", "css:finder"], \n '+
'        ["xpath=//td[@id=\'TITLEBAR0_2CLOSE\']/div", "xpath:idRelative"], \n '+
'        ["xpath=//td[3]/div", "xpath:position"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "XType", \n '+
'      "Target": "${KEY_ENTER}", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, { \n '+
'      "Command": "pause", \n '+
'      "Target": "700", \n '+
'      "Targets": [], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "XType", \n '+
'      "Target": "${KEY_ENTER}", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, { \n '+
'      "Command": "pause", \n '+
'      "Target": "700", \n '+
'      "Targets": [], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "XType", \n '+
'      "Target": "${KEY_ENTER}", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, { \n '+
'      "Command": "pause", \n '+
'      "Target": "700", \n '+
'      "Targets": [], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "selectFrame", \n '+
'      "Target": "relative=parent", \n '+
'      "Targets": [ \n '+
'        ["relative=parent"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "selectFrame", \n '+
'      "Target": "index=0", \n '+
'      "Targets": [ \n '+
'        ["index=0"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "click", \n '+
'      "Target": "id=ICONIMG14", \n '+
'      "Targets": [ \n '+
'        ["id=ICONIMG14", "id"], \n '+
'        ["css=#ICONIMG14", "css:finder"], \n '+
'        ["xpath=//img[@title=\'Pesquisar transação\']", "xpath:img"], \n '+
'        ["xpath=//img[@id=\'ICONIMG14\']", "xpath:attributes"], \n '+
'        ["xpath=//td[@id=\'ICON14\']/img", "xpath:idRelative"], \n '+
'        ["xpath=//td[2]/table/tbody/tr/td/img", "xpath:position"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "type", \n '+
'      "Target": "id=F_62", \n '+
'      "Targets": [ \n '+
'        ["id=F_62", "id"], \n '+
'        ["name=CC", "name"], \n '+
'        ["css=#F_62", "css:finder"], \n '+
'        ["xpath=//input[@id=\'F_62\']", "xpath:attributes"], \n '+
'        ["xpath=//tr[@id=\'ITR59\']/td/table/tbody/tr/td[3]/input", "xpath:idRelative"], \n '+
'        ["xpath=//input", "xpath:position"] \n '+
'      ], \n '+
'      "Value": "fpclpagto" \n '+
'    }, { \n '+
'      "Command": "selectFrame", \n '+
'      "Target": "relative=parent", \n '+
'      "Targets": [ \n '+
'        ["relative=parent"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }  '+
', {  \n '+
'      "Command": "selectFrame", \n '+
'      "Target": "index=1", \n '+
'      "Targets": [ \n '+
'        ["index=1"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "click", \n '+
'      "Target": "id=B_78", \n '+
'      "Targets": [ \n '+
'        ["id=B_78", "id"], \n '+
'        ["css=#B_78", "css:finder"], \n '+
'        ["xpath=//button[@id=\'B_78\']", "xpath:attributes"], \n '+
'        ["xpath=//td[@id=\'TDB78\']/button", "xpath:idRelative"], \n '+
'        ["xpath=//tr[2]/td/table/tbody/tr/td/button", "xpath:position"], \n '+
'        ["xpath=//button[contains(.,\' EFETUAR CÁLCULO ONLINE\')]", "xpath:innerText"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }';


while (i <= f){



    macro += ', { \n '+
'      "Command": "selectFrame", \n '+
'      "Target": "relative=parent", \n '+
'      "Targets": [ \n '+
'        ["relative=parent"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "selectFrame", \n '+
'      "Target": "index=2", \n '+
'      "Targets": [ \n '+
'        ["index=2"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "type", \n '+
'      "Target": "id=F_130", \n '+
'      "Targets": [ \n '+
'        ["id=F_130", "id"], \n '+
'        ["css=#F_130", "css:finder"], \n '+
'        ["xpath=//input[@id=\'F_130\']", "xpath:attributes"], \n '+
'        ["xpath=//tr[@id=\'ITR127\']/td/table/tbody/tr/td[3]/input", "xpath:idRelative"], \n '+
'        ["xpath=//tr[3]/td/table/tbody/tr/td[3]/input", "xpath:position"] \n '+
'      ], \n '+
'      "Value": "'+document.getElementById(i).value+'" \n '+
'    }, { \n '+
'      "Command": "XType", \n '+
'      "Target": "${KEY_ENTER}", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, { \n '+
'      "Command": "pause", \n '+
'      "Target": "700", \n '+
'      "Targets": [], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "selectFrame", \n '+
'      "Target": "relative=parent", \n '+
'      "Targets": [ \n '+
'        ["relative=parent"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "selectFrame", \n '+
'      "Target": "index=0", \n '+
'      "Targets": [ \n '+
'        ["index=0"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "click", \n '+
'      "Target": "id=B_123", \n '+
'      "Targets": [ \n '+
'        ["id=B_123", "id"], \n '+
'        ["css=#B_123", "css:finder"], \n '+
'        ["xpath=//button[@id=\'B_123\']", "xpath:attributes"], \n '+
'        ["xpath=//td[@id=\'TDB123\']/button", "xpath:idRelative"], \n '+
'        ["xpath=//td[3]/button", "xpath:position"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "selectFrame", \n '+
'      "Target": "relative=parent", \n '+
'      "Targets": [ \n '+
'        ["relative=parent"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "selectFrame", \n '+
'      "Target": "index=1", \n '+
'      "Targets": [ \n '+
'        ["index=1"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "click", \n '+
'      "Target": "id=B_190", \n '+
'      "Targets": [ \n '+
'        ["id=B_190", "id"], \n '+
'        ["css=#B_190", "css:finder"], \n '+
'        ["xpath=//button[@id=\'B_190\']", "xpath:attributes"], \n '+
'        ["xpath=//td[@id=\'TDB190\']/button", "xpath:idRelative"], \n '+
'        ["xpath=//td[9]/button", "xpath:position"] \n '+
'      ], \n '+
'      "Value": "", \n '+
'      "opensWindow": true, \n '+
'      "windowHandleName": "win2279", \n '+
'      "windowTimeout": 4000 \n '+
'    }, \n '+
'    { \n '+
'      "Command": "pause", \n '+
'      "Target": "4000", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, \n '+
'   { \n '+
'      "Command": "XType", \n '+
'      "Target": "${KEY_CTRL+KEY_P}", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, \n '+
'    { \n '+
'      "Command": "pause", \n '+
'      "Target": "4000", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, \n '+
'    { \n '+
'      "Command": "XType", \n '+
'      "Target": "${KEY_ENTER}", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, \n '+
'    { \n '+
'      "Command": "pause", \n '+
'      "Target": "4000", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, \n '+
'    { \n '+
'      "Command": "XType", \n '+
'      "Target": "'+document.getElementById(i).value+'", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, \n '+
'    { \n '+
'      "Command": "pause", \n '+
'      "Target": "2000", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, \n '+
'    { \n '+
'      "Command": "XType", \n '+
'      "Target": "${KEY_ENTER}", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, \n '+
'   { \n '+
'      "Command": "XType", \n '+
'      "Target": "${KEY_ALT+KEY_F4}", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, \n '+
'    { \n '+
'      "Command": "pause", \n '+
'      "Target": "2000", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, \n '+
'    { \n '+
'      "Command": "selectWindow", \n '+
'      "Target": "title=https://esiape.sigepe.gov.br/modsiape/servlet/StartCISPage?PAGEURL=/cisnatural/NatLogon.html&xciParameters.natsession=modsiape", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, \n '+
'    { \n '+
'      "Command": "selectFrame", \n '+
'      "Target": "relative=parent", \n '+
'      "Targets": [ \n '+
'        ["relative=parent"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }, { \n '+
'      "Command": "selectFrame", \n '+
'      "Target": "index=1", \n '+
'      "Targets": [ \n '+
'        ["index=1"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }, \n '+
'    { \n '+
'      "Command": "pause", \n '+
'      "Target": "2000", \n '+
'      "Value": "", \n '+
'      "Description": "" \n '+
'    }, \n '+
'     { \n '+
'      "Command": "click", \n '+
'      "Target": "id=B_194", \n '+
'      "Targets": [ \n '+
'        ["id=B_194", "id"], \n '+
'        ["css=#B_194", "css:finder"], \n '+
'        ["xpath=//button[@id=\'B_194\']", "xpath:attributes"], \n '+
'        ["xpath=//td[@id=\'TDB194\']/button", "xpath:idRelative"], \n '+
'        ["xpath=//td[13]/button", "xpath:position"] \n '+
'      ], \n '+
'      "Value": "" \n '+
'    }';


 i++;

}
 
  
    
    macro += ' ] \n '+
'}';
    
    let texto = macro;
      let titulo = "FPCLPAGTO";
   let blob = new Blob([texto], { type: "text/plain;charset=iso-8859-1" });
      saveAs(blob, titulo + ".json");
    
}


function geraProcessamentoBatch(){
        

		var i = 1;
		var i2 = 1;
		var f = 0;
		var siape = new Array();
		
		//pega o valor dos atrasados de vencimento e soma ao valor total de V.B.
		
		while ((document.getElementById(i2).value > 0) && (i2 < 61)){
			f++;
			i2++;
			}


			var macro = '026201\r\n';
		

				while (i <= f){

				macro += '126201'+document.getElementById(i).value+'\r\n';			
				i++;
			}

				macro += '9'+f;
					
					let texto = macro;
					let titulo = "FPCLPAGTO_em_LOTE";
				let blob = new Blob([texto], { type: "text/plain;charset=UTF-8" });
					saveAs(blob, titulo + ".txt");


				

}
       
  
    </script>
        
        
        <%= render "layouts/footer" %>
   


  